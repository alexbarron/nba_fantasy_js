<h1>Create a New Player</h1>
<h4>Enter a Basketball Reference Player Profile URL</h4>
<p>For example Kobe Bryant's profile URL is http://www.basketball-reference.com/players/b/bryanko01.html</p>
<%= render 'form' %>

<h3 id="status"></h3>

<div id="playerResult">
  
  <p id="score"></p>
  <p id="salary"></p>
  <p id="value"></p>

  <table class="table table-striped table-condensed">
    <tr>
      <th>Points</th>
      <th>Assists</th>
      <th>Rebounds</th>  
      <th>Blocks</th>
      <th>Steals</th>
      <th>Games Played</th>
    </tr>
    <tr>
      <td id="points"></td>
      <td id="assists"></td>
      <td id="rebounds"></td>
      <td id="blocks"></td>
      <td id="steals"></td>
      <td id="games_played"></td>
    </tr>
  </table>
</div>

<script type="text/javascript">
  $(function () {
    $('form').submit(function(event) {
      $("#status").text("Loading new player...");

      event.preventDefault();
      
      var player_url = $(this).serialize();
      var url = $(this).attr("action");

      var posting = $.post(url, player_url);

      posting.done(function(data){
        $("#playerResult").show();

        newPlayer = new Player(data.player);
        newPlayer.setInfo();

        $("#status").text("Successfully added " + data.player.name);
        $("#playerUrl").val("");
      })
    });

    function Player(info){
      for(var key in info){
        this[key] = info[key];
      }
    };

    Player.prototype.setInfo = function(){
        $("#score").text('Score: ' + this.score);
        $("#salary").text('Salary: $' + this.salary.toLocaleString());
        $("#value").text('Score Per Million: ' + this.value);

        $("#points").text(this.points);
        $("#assists").text(this.assists);
        $("#rebounds").text(this.rebounds);
        $("#blocks").text(this.blocks);
        $("#steals").text(this.steals);
        $("#games_played").text(this.games_played);
    }
  });
</script>